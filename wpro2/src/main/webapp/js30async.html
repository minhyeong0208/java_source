<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>async ~ await</title>
</head>
<body>
	<h2>Promise 객체를 내부적으로 처리하는 async ~ await라는 키워드</h2>
	일반적인 형태의 소스 코드를 작성하면서 비동기 처리를 할 수 있다.<br>
	
	<!-- 기존의 promise 객체 사용 -->
	<script type="text/javascript">
	const myPromise = (seconds) => new Promise((resolve, reject) => {  // resolve로 이동하기 위해 then 사용, reject로 이동하기 위해 catch 사용
		setTimeout(() => {
			let a = 3;  // 짝수인 경우 resolve, 홀수인 경우, reject을 만난다.
			
			if(a % 2 === 0) resolve('이 값이 then 메소드의 매개변수로 전달.');
			else reject('에러 처리 : reject이 실행되면 catch로 받을 수 있다.');
			
			resolve('이 값이 then 메소드의 매개변수로 전달됨.');  // then 메소드의 파라미터로 전달.
		}, seconds);  // 2초마다 수행
	});
	
	// 형식
	// await는 독립 사용 불가. async 함수 내부에서만 사용 가능.
/*
	async function 함수명() {
		try {
			await 비동기처리메소드();
		} catch(e) {
			
		} finally {
			
		}
	}
*/
	
	
	async function gogo() {
		try {
			const result1 = await myPromise(2000);  // then 메소드 대신 작성.
			console.log(result1);
			
			const result2 = await myPromise(2000);
			console.log(result2);
			
			const result3 = await myPromise(2000);
			console.log(result3);
		} catch(e) {
			console.log('err : ' + e);
		} finally {
			console.log('>> 에러와 상관없이 실행됨 <<');
		}
	}
	
	gogo();
	</script>
	
</body>
</html>